[env:esp32-s3-wroom-n8r16]
platform = espressif32 @ 6.12.0
board = esp32-s3-devkitc-1        ; 开发板型号，实际模组是 WROOM-N8R16
framework = arduino

; ========== 串口配置 ==========
monitor_speed = 115200
upload_speed = 921600
monitor_filters = esp32_exception_decoder, time

; ========== Flash 配置（8MB）==========
board_upload.flash_size = 8MB
board_build.flash_size = 8MB
board_build.filesystem = littlefs

; 分区表 - 使用自定义或默认
board_build.partitions = default_8MB.csv
; 如果 default_8MB.csv 不存在，创建 partitions_8MB.csv 并改为：
; board_build.partitions = partitions_8MB.csv

; ========== PSRAM 配置（16MB OPI）==========
; N8R16 使用 OPI（八线）PSRAM，不是 QSPI
board_build.arduino.memory_type = qio_opi

; 关键：PSRAM 相关定义
build_flags =
    -std=gnu++17
    -I${PROJECT_DIR}/include
    -D CORE_DEBUG_LEVEL=3
    -D CONFIG_ARDUHAL_LOG_COLORS=1
    -D BOARD_HAS_PSRAM                    ; 启用 PSRAM
    -D CONFIG_SPIRAM_SUPPORT=1            ; PSRAM 支持
    -D CONFIG_SPIRAM_USE=1                ; 使用 PSRAM
    -D ARDUINO_USB_MODE=1
    -D ARDUINO_USB_CDC_ON_BOOT=1
    -D PROJECT_VERSION=\"1.0.0\"

build_unflags = -std=gnu++11

; ========== 库依赖 ==========
lib_deps =
    adafruit/Adafruit AHTX0 @ 2.0.5
    adafruit/Adafruit BMP280 Library @ 2.6.8
    claws/BH1750 @ 1.3.0
    adafruit/RTClib @ 2.1.3
    bodmer/TFT_eSPI @ 2.5.43
    bblanchon/ArduinoJson @ 6.21.4
    arduino-libraries/NTPClient @ 3.2.1
    ; Web配置依赖（WiFi/AP/Async JSON API）
    esphome/ESPAsyncWebServer-esphome @ 3.1.0
    esphome/AsyncTCP-esphome @ 2.1.3
